
$(document).ready(function(){$(".checkbox.icheck label, .radio.icheck label").on("hover",function(){$(this).toggleClass("hover");$(this).find(".icheckbox_square, .iradio_square").toggleClass("hover")});$(".checkbox.icheck label").on("click",function(c){c.preventDefault();var b=$(this).find(".icheckbox_square");var a=$(this).find('input[type="checkbox"]');if(b.hasClass("disabled")){return false}$(this).toggleClass("checked");b.toggleClass("checked");if(b.attr("aria-checked")==="false"){b.attr("aria-checked",true);a.attr("checked",true);if(typeof $(this).find('input[type="hidden"][name="_active"]')!="undefined"){$(this).find('input[type="hidden"][name="_active"]').val("on")}if(typeof $(this).find('input[type="hidden"][name="_available"]')!="undefined"){$(this).find('input[type="hidden"][name="_available"]').val("on")}if(typeof $(this).find('input[type="hidden"][name="_termsAccepted"]')!="undefined"){$(this).find('input[type="hidden"][name="_termsAccepted"]').val("on")}}else{b.attr("aria-checked",false);a.attr("checked",false);if(typeof $(this).find('input[type="hidden"][name="_active"]')!="undefined"){$(this).find('input[type="hidden"][name="_active"]').val("off")}if(typeof $(this).find('input[type="hidden"][name="_available"]')!="undefined"){$(this).find('input[type="hidden"][name="_available"]').val("off")}if(typeof $(this).find('input[type="hidden"][name="_termsAccepted"]')!="undefined"){$(this).find('input[type="hidden"][name="_termsAccepted"]').val("off")}}});$(".radio.icheck label").on("click",function(f){f.preventDefault();var d=$(this).find(".iradio_square");var c=$(this).find('input[type="radio"]');var a=$(".radio.icheck label").find(".iradio_square");var b=$(".radio.icheck label").find('input[type="radio"]');if(d.hasClass("disabled")){return false}$(".radio.icheck label").removeClass("checked");a.attr("aria-checked",false).removeClass("checked");b.attr("aria-checked",false);$(this).addClass("checked");d.attr("aria-checked",true).addClass("checked");c.attr("checked",true)});if(typeof $('[data-content="master-template"] .jsDataTableDisabledFilter')!=="undefined"||typeof $('[data-content="custom-template"] .jsDataTableDisabledFilter')!=="undefined"){$('.checkbox.icheck label[for="masterTemplate"], .checkbox.icheck label[for="customTemplate"]').click()}if(typeof $("input.modelCheckbox")!=="undefined"){$("input.modelCheckbox").each(function(){if($(this).is(":checked")){var a=$(this).closest("label");var b=a.find(".icheckbox_square");a.addClass("checked");b.addClass("checked")}else{var a=$(this).closest("label");var b=a.find(".icheckbox_square");b.removeClass("disabled")}})}if($(".js-multi-select")){$(".js-multi-select").select2({placeholder:"--Please Select--"})}});$(document).on("click","a.btn-add-new",function(a){a.preventDefault();if(!$(this).hasClass("dialog-none")){selectAddOption($(this))}if($(this).hasClass("attach-to-branch")){attachToBranch($(this))}});$(document).on("change",'select[data-role="get-templates"]',function(){var a=$(this).val();if(a.length===0){return false}$.get("/accesspoint/templates/"+a+"/ajax").done(function(b){var c="";c+='<option value="">--Please Select--</option>';$.each(b,function(d,e){c+='<option value="'+e.id+'">'+e.template_name+"</option>"});$('select[name="template"]').html(c).attr("disabled",false)})});function selectAddOption(a){var b={};var d=a.attr("data-type");var e=[];var c="";switch(d){case"firegate":b.title="Create New Firegate";e.push({icon:"fa fa-send",label:"Submit",cssClass:"btn-primary",action:function(f){var g=$(this);g.html("Processing...");g.attr("disabled",true);g.closest(".modal-content").find("input,select,button").each(function(){var h=$(this);h.attr("disabled",true)});saveFiregate();f.close()}});break;case"controller":b.title="Create New Controller";e.push({icon:"fa fa-send",label:"Submit",cssClass:"btn-primary",action:function(f){var g=$(this);g.html("Processing...");g.attr("disabled",true);g.closest(".modal-content").find("input,select,button").each(function(){var h=$(this);h.attr("disabled",true)});saveController();f.close()}});break;case"accessPoint":b.title="Create New Access Point";e.push({icon:"fa fa-send",label:"Submit",cssClass:"btn-primary",action:function(f){var g=$(this);g.html("Processing...");g.attr("disabled",true);g.closest(".modal-content").find("input,select,button").each(function(){var h=$(this);h.attr("disabled",true)});saveAccessPoint();f.close()}});break;case"proxy":b.title="Create New Proxy";e.push({icon:"fa fa-send",label:"Submit",cssClass:"btn-primary",action:function(f){var g=$(this);g.html("Processing...");g.attr("disabled",true);g.closest(".modal-content").find("input,select,button").each(function(){var h=$(this);h.attr("disabled",true)});saveProxy();f.close()}});break}c+=buildHtml(d);e.push({icon:"fa fa-times",label:"Cancel",cssClass:"btn-default",action:function(f){f.close()}});b.type="type-default";b.message=c;b.buttons=e;BootstrapDialog.show(b)}function attachToBranch(a){var b=a.attr("data-type");switch(b){case"firegate":attachFiregateToBranch();break;case"accessPoint":attachApToBranch();break;case"proxy":attachProxyToBranch();break}}function buildHtml(c,d){var b="";var f=(typeof d==="object")?d:null;switch(c){case"firegate":var g=$("#access-point").data("models");b+='<div class="form-group">';b+='<label class="required">Serial Number</label>';b+='<input type="text" class="form-control" name="serialNumber" id="dialogSerialNumber" />';b+="</div>";b+='<div class="form-group">';b+='<label class="required">Model</label>';b+='<select class="form-control" name="model" id="dialogModel" data-role="get-templates">';b+='<option value="">--Please Select--</option>';$.each(g,function(h,i){b+='<option value="'+i.id+'">'+i.model_name+"</option>"});b+="</select>";b+="</div>";b+='<div class="form-group">';b+='<label class="required">Template</label>';b+='<select class="form-control" name="template" id="dialogTemplate" disabled="disabled">';b+='<option value="">--Please Select--</option>';b+="</select>";b+="</div>";break;case"controller":b+='<div class="form-group">';b+='<label class="required">Name</label>';b+='<input type="text" class="form-control" name="controllerName" id="dialogControllerName" />';b+="</div>";break;case"accessPoint":var e=$("#access-point").data("controllers");var a=$("#access-point").data("proxies");b+='<div class="form-group">';b+='<label class="required">MAC Address</label>';b+='<input type="text" class="form-control" name="macAddress" id="dialogMacAddress" />';b+="</div>";b+='<div class="form-group">';b+='<label class="required">AP Name</label>';b+='<input type="text" class="form-control" name="apName" id="dialogApName" />';b+="</div>";b+='<div class="form-group">';b+='<label class="required">AP Type</label>';b+='<select id="apType" class="form-control" required="required" data-val-type="">';b+=' <option value="">--Please Select--</option>';b+='<option value="NAS">NAS</option>';b+='<option value="Non-NAS">Non-NAS</option>';b+="</select>";b+="</div>";b+='<div class="form-group">';b+='<label class="required">IP Address</label>';b+='<input type="text" class="form-control" name="ipAddress" id="dialogIpAddress" />';b+="</div>";b+='<div class="form-group">';b+='<label class="required">Controller</label>';b+='<select class="form-control" name="controller_old" id="dialogController" onchange="filterProxies()">';b+='<option value="">--Please Select--</option>';if(e!=null&&e.length>0){$.each(e,function(i,h){b+='<option value="'+h.id+'">'+h.name+"</option>"})}b+="</select>";b+="</div>";b+='<div class="form-group">';b+='<label class="required">Proxy</label>';b+='<select class="form-control" name="proxy" disabled="disabled" id="dialogProxy">';b+='<option value="">--Please Select--</option>';if(a!=null&&a.length>0){$.each(a,function(h,i){b+='<option data-controller_old-id="'+i.controller_id+'" value="'+i.id+'">'+i.name+"</option>"})}b+="</select>";b+="</div>";break;case"proxy":var e=$("#access-point").data("controllers");b+='<div class="form-group">';b+='<label class="required">Name</label>';b+='<input type="text" class="form-control" name="proxyName" id="dialogProxyName" />';b+="</div>";b+='<div class="form-group">';b+='<label class="required">Proxy Identity</label>';b+='<input type="text" class="form-control" name="proxyIdentity" id="dialogProxyIdentity" />';b+="</div>";b+='<div class="form-group">';b+='<label class="required">Controller</label>';b+='<select class="form-control" name="controller_old" id="dialogProxyController">';b+='<option value="">--Please Select--</option>';if(e!=null&&e.length>0){$.each(e,function(i,h){b+='<option value="'+h.id+'">'+h.name+"</option>"})}b+="</select>";b+="</div>";break}return b}function saveFiregate(){var a={model:$("#dialogModel").val(),serial_number:$("#dialogSerialNumber").val(),template:$("#dialogTemplate").val()};var b=$.ajax({url:"/isp/gateway/save",type:"POST",contentType:"application/json",data:JSON.stringify(a),processData:false,dataType:"text"});b.done(function(c){var d=(typeof c==="object")?c:$.parseJSON(c);if(d.status==="NOT_PARAMETERIZED"){showParametersScreen(d.selectedGatewayId)}$('select[name="configure-firegate"]').append('<option value="'+d.selectedGatewayId+'" selected="selected">'+d.serial+"</option>")})}function showParametersScreen(a){$.ajax({url:"/admin/gateway/config/parameters/"+a+"/populate/alt",type:"GET",cache:false,dataType:"html",success:function(b){$("#adminModal").modal("show");$("#adminModalBody").html(b);$("#adminModalBody").append('<button class="btn btn-primary" onclick="saveParameters('+a+')"><span class="bootstrap-dialog-button-icon fa fa-send"></span>Save</button> ')},error:function(b){console.log(b)}})}function saveParameters(f){var d={parameters:[]};var c=$(".unpopulated").size();var e=$(".editedParam").size();for(var a=1;a<=e;a++){var g={id:"",name:"",type:"",value:"",readOnly:false};g.id=$("#editedParamId"+a).val();g.name=$("#editedParamName"+a).val();g.type=$("#editedParamType"+a).val();g.value=$("#editedParamValue"+a).val();d.parameters.push(g)}for(var a=1;a<=c;a++){var g={name:"",type:"",value:"",readOnly:false};g.name=$("#unpopulatedParameterName"+a).val();g.type=$("#unpopulatedParameterType"+a).val();g.value=$("#unpopulatedParameterValue"+a).val();d.parameters.push(g)}var b=$.ajax({url:"/admin/gateway/"+f+"/config/parameters",type:"POST",contentType:"application/json",data:JSON.stringify(d.parameters),processData:false,dataType:"text"});b.done(function(h){var j=(typeof h=="object")?h:$.parseJSON(h);if(j.success!=null&&j.success!=""){$("#adminModal").modal("hide");$("#jsonSuccess").show();$("#jsonSuccessText").html(j.success);if(j.selectedGatewayStatus!=null&&j.selectedGatewayStatus!=""){var i=$("tr[data-gateway-id='"+j.selectedGatewayId+"']").find("div.gateway-status");switch(j.selectedGatewayStatus){case"NO_CONFIG":i.html('<span  class="badge bg-red" style="color: red">No Config</span>');break;case"NOT_PARAMETERIZED":i.html('<span  class="badge bg-red" style="color: red">Not Parameterized</span>');break;case"PENDING":i.html('<span  class="badge bg-orange" style="color: orange">Pending</span>');break;case"CONFIGURED":i.html('<span class="badge bg-green" style="color: green">Configured</span>');break}}}})}function filterProxies(){var a=$("#dialogController").find(":selected").val();$("#dialogProxy").removeAttr("disabled");$("#dialogProxy >option").each(function(){if($(this).hasAttr("data-controller_old-id")){if($(this).attr("data-controller_old-id")==a){$(this).show()}else{$(this).hide()}}})}function saveController(){var a={brand_id:$("input#hidden-brand").val(),name:$("#dialogControllerName").val()};var b=$.ajax({url:"/controller_old/json/add/",type:"POST",contentType:"application/json",data:JSON.stringify(a),processData:false,dataType:"text"});b.done(function(c){var d=(typeof c==="object")?c:$.parseJSON(c);console.log(d)})}function saveAccessPoint(){var c=$("#hidden-brand").val();var a={brand_id:c,mac_address:$("#dialogMacAddress").val(),ip_address:$("#dialogIpAddress").val(),ap_name:$("#dialogApName").val(),type:$("#apType").find(":selected").val(),proxy_id:$("#dialogProxy").val(),controller_id:$("#dialogController").val()};console.log(a);var b=$.ajax({url:"/accesspoint/save/ajax",type:"POST",contentType:"application/json",data:JSON.stringify(a),processData:false,dataType:"json"});b.done(function(d){var e=(typeof d==="object")?d:$.parseJSON(d);console.log(e);if(e!=null){$('select[name="configure-ap"]').append('<option value="'+e.id+'" selected="selected">'+e.ap_name+"</option>")}})}function saveProxy(){var e=$("#hidden-brand").val();var d=$("#dialogProxyController").find(":selected").val();var f=$("#dialogProxyName").val();var b=$("#dialogProxyIdentity").val();var a={brand_id:e,name:f,controller_id:d,proxy_identity:b};var c=$.ajax({url:"/proxy/json/add/",type:"POST",contentType:"application/json",data:JSON.stringify(a),processData:false,dataType:"text"});c.done(function(h){var j=(typeof h=="object")?h:$.parseJSON(h);console.log(j);var g='<option selected="selected" data-controller_old-id="'+h.controller_id+'" value="'+j.id+'">'+j.name+"</option>";$("#selectedProxy").val("");$("#selectedProxy").append(g);$("#jsonSuccess").show();$("#jsonSuccessText").html("Proxy added successfully.");$("#proxyModal").modal("hide");var i=$("#hidden-branch").val();getProxy(i)})}function attachFiregateToBranch(){var c=$('select[name="configure-firegate"]').val();var b=$("input#hidden-branch").val();var e="/inventory/link/gateway/"+c+"/branch/"+b;var a={branch_id:b,firegate_id:c};console.log(a);var d=$.ajax({url:e,type:"POST",contentType:"application/json",data:JSON.stringify(a),processData:false,dataType:"text"});d.done(function(f){var g=(typeof f==="object")?f:$.parseJSON(f);console.log(g);$("#jsonSuccess").show();$("#jsonSuccessText").html("Successfully linked Firegate to Branch.");getGateway(b)})}function attachApToBranch(){var c=$('select[name="configure-ap"]').val();var b=$("input#hidden-branch").val();var e="/inventory/link/accesspoint/branch/"+b;var a={branch_id:b,access_point_id:c};console.log(a);var d=$.ajax({url:e,type:"POST",contentType:"application/json",data:JSON.stringify(a),processData:false,dataType:"text"});d.done(function(f){var g=(typeof f==="object")?f:$.parseJSON(f);console.log(g);$("#jsonSuccess").show();$("#jsonSuccessText").html("Successfully linked AP to branch.");getAccessPoints(b)})}function attachProxyToBranch(){var c=$('select[name="configure-proxy"]').val();var b=$("input#hidden-branch").val();var e="/inventory/link/proxy/"+c+"/branch/"+b;var a={branch_id:b,proxy_id:c};console.log(a);var d=$.ajax({url:e,type:"POST",contentType:"application/json",data:JSON.stringify(a),processData:false,dataType:"text"});d.done(function(f){var g=(typeof f==="object")?f:$.parseJSON(f);console.log(g);$("#jsonSuccess").show();$("#jsonSuccessText").html("Successfully linked proxy to branch.");getProxy(b)})}$.expr[":"].containsIgnoreCase=function(c,b,a){return jQuery(c).text().toUpperCase().indexOf(a[3].toUpperCase())>=0};